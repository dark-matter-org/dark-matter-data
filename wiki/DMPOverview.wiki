#summary An overview of the Dark Matter Protocol.

<wiki:toc />

= The Dark Matter Protocol =

Many of the interfaces to data that I've seen for applications, web and desktop alike, have been ad hoc in nature. When you access data in this way, the interface tends to grow in an organic way and access methods tend to follow the whim of the individual designers who work on the project.

Some will argue that this is the appropriate way to approach interface design; that you're dealing with an object oriented system and you should name your methods according to their purpose to make things more clearly understandable. On this topic, you will get no argument from me, I like well designed, well named interfaces.

However, when dealing with data, it's useful to have a clear set of standard interfaces to perform CRUDE operations - see the [DMDOverview#It_Starts_with_a_Model Dark Matter Overview] for a definition of CRUDE. The Dark Matter Protocol provides that standard interface to data, as well as to the events associated with the data and being able to trigger behavior against your objects.

As mentioned in [DMDGoalsAndPhilosophy#Manipulate_Your_Data_in_a_Rational_Way Goals & Philosophy] page, the Dark Matter Protocol is based on the [http://en.wikipedia.org/wiki/Common_management_information_protocol Common Management Information Protocol] (CMIP). Although CMIP and the [http://en.wikipedia.org/wiki/Open_Systems_Interconnection Open Systems Interconnection] (OSI) intiative of which it was a part are now pretty much obsolete, the basic concepts of CMIP remain quite valid.

[http://en.wikipedia.org/wiki/Phrases_from_The_Hitchhiker%27s_Guide_to_the_Galaxy#Don.27t_Panic DON'T PANIC!] The Dark Matter Protocol IS NOT AN IMPLEMENTATION OF CMIP!

_"Using concepts from"_ and _"implementation of"_ are two different things. Just so that we're clear. 
 

The protocol is composed of the following messages:

<table width="820">

<tr>
<td width="140" valign="top">
*`LoginRequest`*
*`LoginResponse`*
</td>
<td valign="top">
The [DMPLoginRequest LoginRequest] provides a standard means of authentication a user of the system. The [DMPLoginRequest LoginResponse] may contain a session identifier that should be passed along in all subsequent requests.
</td>
</tr>

<tr>
<td width="140" valign="top">
*`LogoutRequest`*
*`LogoutResponse`*
</td>
<td valign="top">
The [DMPLogoutRequest LogoutRequest] provides a standard mechanism for signing out of an application in a graceful manner.

</td>
</tr>


<tr>
<td width="140" valign="top">
*`GetRequest`*
*`GetResponse`*
</td>
<td valign="top">
The `GetRequest` provides the `R` part of `CRUDE` i.e. the Retrieval of one or more [DMOOverview DMOs].

</td>
</tr>

<tr>
<td valign="top">
*`SetRequest`*
*`SetResponse`*
</td>
<td valign="top">
The `SetRequest` provides the `U` part of `CRUDE` and lets you Update the attributes of one or more [DMOOverview DMOs].
</td>
</tr>

<tr>
<td valign="top">
*`CreateRequest`*
*`CreateResponse`*
</td>
<td valign="top">
The `CreateRequest` provides, you guessed it, the `C` part of `CRUDE` i.e. the ability to Create a new object.
</td>
</tr>

<tr>
<td valign="top">
*`DeleteRequest`*
*`DeleteResponse`*
</td>
<td valign="top">
The `DeleteRequest` allows for the Deletion of one or more objects. That's the `D` part of `CRUDE`, for those who may have missed it ;-)
</td>
</tr>

<tr>
<td valign="top">
*`ActionRequest`*
*`ActionResponse`*
</td>
<td valign="top">
Here's your opportunity to get "organic" and trigger behaviour on objects based on your previously defined [DMSActionDefinition ActionDefinitions]. You are free to name actions whatever you want so that you can put your stamp of individuality on your protocol.
</td>
</tr>

<tr>
<td valign="top">
*`NotifyRequest`*
*`NotifyResponse`*
</td>
<td valign="top">
The `NotifyRequest` allows you to register for events that indicate when [DMOOverview DMOs] are created, deleted or modified.
</td>
</tr>

<tr>
<td valign="top">
*`DMPEvent`*
</td>
<td valign="top">
The DMPEvent is an autonomous notification of creation of, deletion of, or modifications to [DMOOverview DMOs]. This is also the `E` part of `CRUDE`, but I've named it DMPEvent so that people don't get it confused with all of the other "Event" classes out there. So many events! So few names for them!
</td>
</tr>

</table>

== The `DMPMessage` Base Class == 

All Dark Matter Protocol messages are derived from DMPMessage. It has the following attributes:

<table width="820">

<tr>
<td width="140" valign="top">
*`requestID`*
</td>
<td>
uniquely identifies a request message from a particular source. This is actually a multi-valued attribute; the reasons for this are covered in the [DMDAdvancedConcepts Advanced Concepts] section. For most situations, just adding a single identifier is sufficient.

Due to the fact that DMP is a truly asynchronous protocol (event in GWT), the `requestID` allows for association of `Responses` with their initiating `Requests` where a complete response may span several messages. All `Responses` to the same `Request` will have the same `requestID` as the `Request`
</td>
</tr>

<tr>
<td valign="top">
*`timeMS`*
</td>
<td>
you can optionally set `timeMS` on your `Requests` and it will be echoed back in the subsequent `Responses`. This allows you to determine the overall responsiveness or your server connection.
</td>
</tr>

</table>

== The `Request` Base Class ==

The `Request` class has two other attributes beyond the `DMPMessage`:

<table width="820">

<tr>
<td width="140" valign="top">
*`handlerID`*
</td>
<td valign="top">
is used to route responses back to the appropriate handler functions if you are using the Dark Matter GWT Communications mechanisms in your client.
</td>
</tr>

<tr>
<td width="140" valign="top">
*`sessionID`*
</td>
<td valign="top">
is a session identifier provided by the server when you log in. Whether or not you use these mechanisms is up to you, but forcing the client to identify itself with an authenticated session identifier is a useful practice.

Handling of session identifiers is provided as a standard part of the Dark Matter GWT Communications mechanisms.
</td>
</tr>

</table>

== The `Response` Base Class ==

The `Response` class has a few more attributes that generally reflect the state of the response.

<table width="820">

<tr>
<td width="140" valign="top">
*`handlerID`*
</td>
<td valign="top">
is just reflected back from the `Request`
</td>
</tr>

<tr>
<td width="140" valign="top">
*`responseType`*
</td>
<td valign="top">
GWT RPC provides its own indication of overall success or failure, but assuming that the request actually made it through, DMP allows you to indicate further granularity of feedback for a response.
<table width="680">

<tr>
<td width="160" valign="top">
*`SUCCESS`*
</td>
<td>
the request generated a successful response.
</td>
</tr>

<tr>
<td valign="top">
*`WARNING`*
</td>
<td>
the request was successful but something was slightly amiss. If you indicate a warning, you should also provide some other useful information via `responseText`.
</td>
</tr>

<tr>
<td width="100" valign="top">
*`ERROR`*
</td>
<td>
something went wrong. Some other information should be provided in `responseText`.
</td>
</tr>

<tr>
<td width="100" valign="top">
*`PROGRESSTEXT`*
</td>
<td>
if a request is of indeterminate length in terms of response, you might want to provide feedback on its progress. If the percentage of completion can't be completed, you might provide a textual indication via the responseText.
</td>
</tr>

<tr>
<td width="100" valign="top">
*`PROGRESSPERCENTAGE`*
</td>
<td>
if a request is of indeterminate length in terms of response and you can calculate a percentage for completeness, you can send it via responseText.
</td>
</tr>

</table>

</td>
</tr>

<tr>
<td width="140" valign="top">
*`responseText`*
</td>
<td valign="top">
is a holding place for error, warning and progress information (either text or percentage).
</td>
</tr>

<tr>
<td width="140" valign="top">
*`responseCategory`*
</td>
<td valign="top">
is generally used to indicate a broad category of error if an error is encountered. The allowed values are `SOFTWARE`, `SECURITY`, `REPOSITORY`, `COMMS` and `OPERATIONAL`.
</td>
</tr>

<tr>
<td width="140" valign="top">
*`lastResponse`*
</td>
<td valign="top">
is a flag to indicate if this response is the last one for a given request. Since DMP messages are asynchronous, this flag is important in situations where there can be many responses for a given request.
</td>
</tr>

</table>