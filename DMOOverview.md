

# Dark Matter Objects #

<table>
<tr>
<td width='200'>
<img width='180' src='http://www.dark-matter-data.org/images/dmo.png' />
</td>
<td>
A Dark Matter Object (DMO - pronounced - dee mo) is a standard Java object that is generated by the <a href='DMOGenerator.md'>DMO Generator</a> tool. All DMOs derive from <a href='http://code.google.com/p/dark-matter-data/source/browse/trunk/src/org/dmd/dmc/DmcObject.java'>org.dmd.dmc.DmcObject</a>, sometimes referred to as the Dark Matter Core object. Despite being a fairly large class, the <code>DmcObject</code> just provides a holder for a collection of attributes; that's basically it.<br>
<br>
Instead of generating classes that have discrete member attributes, Dark Matter relies on a hash map of attribute containers that hold the attribute values, either single or multi-valued. This approach may seem odd, but it allows for a great deal of common functionality to be provided by <code>DmcObject</code>. In addition, the overhead introduced by this mechanism is very low on a per object basis, and, in fact keeps the memory footprint of objects as low as possible because you aren't maintaining handles to attributes that have no values.<br>
<br>
The only other storage associated with a DMO is the info vector which is used to facilitate things like <a href='DMOBackReferenceTracking.md'>Back Reference Tracking</a> and <a href='DMOModRec.md'>Modification Recording</a>. The info vector is designed to grow/shrink as required so that we always use the least amount of space required.<br>
</td>
</tr>
</table>

## DMO Features ##

The following standard features are supported by DMOs:

  * presentation in [Object Instance Format](#Object_Instance_Format.md) (OIF), a very clean, human readable form of an object

  * presentation in [JSON](http://www.json.org/) format

  * the ability to access attributes by name (very handy for data binding in various frameworks)

  * the ability to access attributes by integer ID. This provides rapid access to an attribute via the generated getters/setters.

  * the ability to serialize/deserialize the object in a manner very similar to [Google Protocol Buffers](http://code.google.com/apis/protocolbuffers/)

  * the ability to [record modifications](DMOModRec.md) made to the object so that these modifications can be transmitted in a [Dark Matter Protocol](DMPOverview.md) `SetRequest` or in a [Dark Matter Protocol](DMPEvent.md) event.

  * the ability to perform [Lazy Object Reference Resolution](DMOLazyObjectReferenceResolution.md)

  * the ability to perform [Back Reference Tracking](DMOBackReferenceTracking.md)

  * the ability to automatically remove references to an object when it is deleted (which does not depend on the [Weak Reference](http://download.oracle.com/javase/1.4.2/docs/api/java/lang/ref/WeakReference.html) concept). This is useful in GWT environments where the [JRE Emulation](http://code.google.com/webtoolkit/doc/1.6/RefJreEmulation.html) does not support weak references.

  * the ability cast a DMO to the appropriate type of [Dark Matter Wrapper](DMWOverview.md) object that provides behavior in a particular operational context

  * the ability to take a [Slice](http://code.google.com/p/dark-matter-data/wiki/EXContacts2#Slicing) of an object i.e. to grab a subset of its attributes; very handy when you only need summary information from an object when it is first displayed by a client

## Object Instance Format ##

Object Instance Format (OIF) is an ASCII form of a DMO that's suitable for debugging and/or object persistence and is also used to represent object instances in all Dark Matter configuration files. It is easily parsed by using a `DmoParser` or a `DmwParser` which are schema driven object parsers.

```
class [auxiliary classes]
sv-attribute  value
mv-attribute1 value
mv-attribute1 value
mv-attribute2 value
sv-attribute
{
DMO
}
mv-attribute
[
{
DMO 1
}
{
DMO 2
}
{
DMO n
}
]
```

An object always starts with the class name as defined in a [Dark Matter Schema](DMSOverview.md).

This name may be followed by one of more [auxiliary class](DMSClassDefinition.md) names. These indicate that the object has been decorated with additional attributes associated with the auxiliary classes.

Single valued attributes (sv-attribute) are displayed as the attribute name followed by the value.

Multi-valued attributes (mv-attribute) are displayed as the attribute name followed by the value and subsequent lines in the same format, one for each value in the collection of values.

If a single valued attribute refers directly to a DMO, the attribute name is displayed and the DMO is dumped in OIF format between { } braces (on separate lines).

If a multi-valued attribute refers to a collection of DMOS, the attribute name is displayed, followed by [ ] (on separate lines) which contain a series of DMOs dumped in OIF format between { } braces (on separate lines).

## Editting OIF Files ##

All configuration files used by Dark Matter are in OIF format and can be editted with any text editor.

However, since the commenting mechanism for OIF is the standard, single line Java comment style:

```
SomeObject
attribute1 value
//this is a comment
attribute2 another value
```

it is useful to associate the various Dark Matter configuration file extensions with the Java editor:

  * open your Eclipse preferences
  * Select `General->Editors->File Associations`
  * Click `"Add"`
  * Enter `*.dms`
  * Select the newly added `*.dms` File Type
  * Click `"Add..."` in the Associated editors area
  * Select `"Java Editor"` and hit OK

Some other extensions you might want to associate with the Java Editor are:

  * `*.dmd` (Dark Matter Definition files used for classes, attributes etc.)
  * `*.mvc` (Model View Controller configurations)
  * `*.dmg` (Dark Matter Generator configurations)


## `DmcObject`.toOIF() ##

Calling the toOIF() method on a DMO will dump the object in OIF form with padding for the attribute names so that the object is easy to read.
Here's part of a Stock object for a popular company as it might appear in OIF form:

```
Stock
name         Google Inc.
stockSymbol  GOOG
lastTrade    525.10
tradeTime    2011:04:21 16:59:43
change       -0.63
prevClose    525.73
open         527.49
dayRange     522.39 528.28
yearRange    433.63 642.96
```